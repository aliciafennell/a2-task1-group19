---
title: "Assignment 2 Task 1 Group 19"
author: "Alicia Fennell, Amber McEldowney, Jennifer Truong"
date: "2/2/2021"
output: 
  html_document:
    code_folding: hide

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)
```


## Overview 

Data for this project comes from Columbia River DART (Data Access in Real Time); the observations used in this project span from January 1, 2001 to December 31, 2010. Adult salmon passage was visually counted and recorded at major dams on Columbia and Snake Rivers. 

This report looks at the passage of Coho, Jack Coho, and Steelhead at the Willamette Falls fish ladder in Oregon. Below, we have explored the data using time series plots, seasonplots, and summary statistics and analysis. 


![*Willamette Falls in Oregon. Photo: Willamette Falls Legacy Project*](photo.jpg)

## Adult Fish Passage at Willamette Falls Fish Ladder {.tabset}

### Time series

```{r}

## Read in packages 
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(tsibble)

## Read in the data, keep only the columns of interest, replace "NA" with 0, and clean names
fish_af <- read.csv(here("data", "willamette_fish_passage.csv")) %>% 
  select("Date", "Coho", "Jack.Coho", "Steelhead") %>% 
  mutate_all(~replace(., is.na(.), 0)) %>% 
  clean_names()
  
## Convert to tsibble 
fish_ts <- fish_af %>% 
  mutate(date = lubridate::mdy(date)) %>% 
  as_tsibble(key = NULL, index = date)

## Plot the time series data
# ggplot() +
#   geom_line(data = fish_ts, aes(x = date, y = coho)) +
#   labs(x = "Date",
#        y = "Number of Coho")

## Make data frames for each fish by monthyears  
coho_month <- fish_ts %>% 
  index_by(yr_mo = ~yearmonth(.)) %>% 
  summarize(monthly_mean_coho = mean(coho, na.rm = TRUE))

jack_month <- fish_ts %>% 
  index_by(yr_mo = ~yearmonth(.)) %>% 
  summarize(monthly_mean_jack = mean(jack_coho, na.rm = TRUE))

steel_month <- fish_ts %>% 
  index_by(yr_mo = ~yearmonth(.)) %>% 
  summarize(monthly_mean_steel = mean(steelhead, na.rm = TRUE))
```


```{r}
## Plot time series fish runs 
ggplot() +
  geom_line(data = coho_month,
       aes(x = yr_mo,
           y = monthly_mean_coho,
           colour = "Coho"),
        alpha = 0.7,
        size = 1.2) +
  geom_line(data = jack_month,
       aes(x = yr_mo,
           y = monthly_mean_jack,
           colour = "Jack Coho"),
       alpha = 0.7,
       size = 1.2) +
  geom_line(data = steel_month,
       aes(x = yr_mo,
           y = monthly_mean_steel,
           colour = "Steelhead"),
       alpha = 0.7,
      size = 1.2) +
  labs(x = "Month and Year",
       y = "Number of Fish",
       title = "Adult Passage of Coho, Jack Coho, and Steelhead at Willamette Falls") +
  theme_minimal() +
  scale_colour_manual(values = c("dodgerblue4", "darkorchid4", "springgreen4")) 

  
```

- bullet points summarizing 
- trends... 

### Seasonplots
```{r}
# Attach feasts package
library(feasts)
```
 
```{r}
# Pivot longer
fish_ts_longer <- fish_ts %>%
  pivot_longer(2:4,
               names_to = "species", # Move each species to its own column
               values_to = "n") %>%
  group_by(species) %>% # Group by species
  index_by(yr_mo = ~yearmonth(.)) %>% # Group by year & month
  summarize(monthly_mean = mean(n, na.rm = TRUE)) # Summarize the mean for each species for each month
  

# Make seasonplot
fish_ts_longer %>%
  gg_season(y = monthly_mean)
```

- bulletpoint 1
- bulletpoint 2

### Tab 3 woohooo!